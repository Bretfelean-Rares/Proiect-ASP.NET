<br />
@{
    var s = ViewBag.SearchString as string;
}

@if (!string.IsNullOrEmpty(s))
{
    <h2 class="text-center">Afisare rezultate cautare: "@s"</h2>
}
else
{
    <h2 class="text-center">Afisare bookmark-uri</h2>
}

<div class="mb-3">
    <a class="btn @(ViewBag.Sort == "recent" ? "btn-primary" : "btn-outline-primary")"
       asp-action="Index" asp-route-sort="recent" asp-route-page="1">
        Recent
    </a>

    <a class="btn @(ViewBag.Sort == "popular" ? "btn-primary" : "btn-outline-primary")"
       asp-action="Index" asp-route-sort="popular" asp-route-page="1">
        Populare
    </a>
</div>

<br />

@if (ViewBag.Message != null)
{
    <h2 class="p-3 rounded-3 text-center mb-5 alert @ViewBag.Alert">
        @ViewBag.Message
    </h2>
}

<br />

<div class="row">
    @foreach (var bookmark in ViewBag.Bookmarks)
    {
        <div class="col-md-6 mb-4">
            <div class="card h-100 shadow-sm bookmark-card">
                @if (!string.IsNullOrEmpty(bookmark.MediaContent))
                {
                    var media = bookmark.MediaContent.ToLower();

                    <div style="height:180px; overflow:hidden; background:#000;">
                        @if (media.EndsWith(".mp4") || media.EndsWith(".mov"))
                        {
                            <video muted
                                   style="width:100%; height:100%; object-fit:cover;">
                                <source src="@bookmark.MediaContent" type="video/mp4" />
                            </video>
                        }
                        else
                        {
                            <img src="@bookmark.MediaContent"
                                 style="width:100%; height:100%; object-fit:cover;" />
                        }
                    </div>
                }
                <div class="card-body d-flex flex-column">

                    <partial name="BookmarkInfo" model="bookmark"/>

                    <div class="mt-auto d-flex justify-content-between align-items-center">
                        <div class="text-muted small">
                            <i class="bi bi-heart-fill text-danger"></i>
                            @bookmark.VotesCount
                        </div>

                        <a class="btn btn-outline-primary btn-sm"
                           asp-controller="Bookmark"
                           asp-action="Show"
                           asp-route-id="@bookmark.Id">
                            Vezi
                        </a>
                    </div>

                </div>
            </div>
        </div>
    }
</div>

@{
    int page = ViewBag.Page;
    int totalPages = ViewBag.TotalPages;
    string sort = ViewBag.Sort;
}

<nav>
    <ul class="pagination">
        <li class="page-item @(page == 1 ? "disabled" : "")">
            <a class="page-link" asp-action="Index" asp-route-sort="@sort" asp-route-page="@(page - 1)">Prev</a>
        </li>

        @for (int i = 1; i <= totalPages; i++)
        {
            <li class="page-item @(i == page ? "active" : "")">
                <a class="page-link" asp-action="Index" asp-route-sort="@sort" asp-route-page="@i">@i</a>
            </li>
        }

        <li class="page-item @(page == totalPages ? "disabled" : "")">
            <a class="page-link" asp-action="Index" asp-route-sort="@sort" asp-route-page="@(page + 1)">Next</a>
        </li>
    </ul>
</nav>